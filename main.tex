\documentclass[10pt,a5paper,twoside]{book}
\usepackage{geometry}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\addto\captionsenglish{\renewcommand{\chaptername}{Day}}

\usepackage{libertine}
\usepackage[scaled=0.95]{inconsolata}
\usepackage{microtype}
\SetTracking
  [ spacing = {25*,166, } ]
  { encoding = *,
    shape = sc }
  { 50 }

\usepackage{graphicx}
\usepackage{listings}
\lstset{
  basicstyle=\normalsize\ttfamily\lst@ifdisplaystyle\footnotesize\fi,
  breaklines=true,
  breakatwhitespace=true,
  keepspaces=true,
  columns=fixed,
  showspaces=false,
  showstringspaces=false,
  xleftmargin=\parindent,
  language=Perl
}

% Environment to show command-line
\lstnewenvironment{shell}
  {\lstset{morecomment=[l]{cpan>},
           morecomment=[l]{$},
           commentstyle=\bfseries,
           breaklines=true,
           breakatwhitespace=false,
           breakindent=0pt}}
  {}

\usepackage{titlesec}

% Headers and footers
\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{main}{%
  \fancyhf{}
  \fancyhead[CO,CE]{\small\nouppercase{\leftmark}}
  \fancyhead[LE,RO]{\sffamily\bfseries\thepage}}
\fancypagestyle{plain}{%
  \fancyhead{}
  \fancyfoot[LE,RO]{\sffamily\bfseries\thepage}}
\pagestyle{main}
\renewcommand{\chaptermark}[1]{%
  \markboth{\sffamily\textsc{\lsstyle\chaptername} \thechapter\ \// #1}{}}
% To have a blank page completely blank before a chapter page
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
  \hbox{}
  \thispagestyle{empty}
  \newpage
  \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother

\PassOptionsToPackage{hyphens}{url}
\usepackage{hyperref}

\titleformat{\chapter}[display]
    {\normalfont\rmfamily\filcenter}
    {\LARGE\scshape\lsstyle \chaptername{} \thechapter}
    {0.5pc}
    {\Large\itshape}
\titlespacing*{\chapter}
  {0pt}{*0}{*10}

\titleformat{\section}
  {\normalfont\large\bfseries}
  {\llap{\thesection\hspace{1.5ex}}}
  {0pt}
  {}
\titlespacing*{\section}
  {0pt}{*2}{*1}

\renewcommand{\thesection}{\arabic{section}}
\graphicspath{{images/}}

% Create a footnote for each href link
\let\oldhref\href
\renewcommand{\href}[2]{%
  \oldhref{#1}{#2}%
  \footnote{\uri{#1}}%
}

% For typeset url, filename, ...
\DeclareUrlCommand\uri{\def\UrlFont{\rmfamily\itshape}}

\begin{document}

\title{Plack Handbook}
\author{Tatsuhiko Miyagawa}
\date{}

\frontmatter

\maketitle

\tableofcontents

\include{introduction}

\mainmatter

\include{allchapters}

\backmatter

\end{document}

